<!DOCTYPE html>
<html lang="en" id="dnscrypt-proxy">
    <head>
        <title>
            {{.Title}}
        </title>
        <link rel="stylesheet" type="text/css" href="/webman/3rdparty/dnscrypt-proxy/style.css">
    </head>
    <body>
        <div class="message">
            <p class="error">{{.ErrorMessage}}</p>
            <p class="success">{{.SuccessMessage}}</p>
        </div>
        <form method="get" class="fileSelector">
            <span id="fileSelect">
                <select name="file">
                    {{- $File := .File -}}
                    {{- range $key, $value := .Files -}}
                        {{- if eq $File $key }}
                    <option value="{{ $key }}" selected>{{ $value }}</option>
                        {{- else }}
                    <option value="{{ $key }}">{{ $value }}</option>
                        {{- end -}}
                    {{- end }}
                </select>
            </span>
            <!-- <input class="btn" type="submit" value="Open"> -->
        </form>
        <form method="post" class="fileEditor">
            <input type="hidden" name="file" value="{{.File}}">
            <div id="fileContent">
                <textarea name="fileContent" autocomplete="off">{{.FileData}}</textarea>
            </div>
            <input class="btn primary" type="submit" value="Save">
        </form>
    </body>
    <script src="codemirror/lib/codemirror.js"></script>
    <link rel="stylesheet" href="codemirror/lib/codemirror.css">
    <script src="codemirror/mode/toml/toml.js"></script>
    <script type="text/javascript">
        textArea = document.getElementsByTagName('textarea')[0]
        if (typeof CodeMirror == "undefined") {
            textArea.style.opacity = 1
        }
        CodeMirror.fromTextArea(textArea, {
            lineNumbers: true
        });
    </script>
    <script type="text/javascript">
        function setGetParameter (key, value) {
            var baseUrl = [location.protocol, '//', location.host, location.pathname].join('')
            var param = '?' + key + '=' + value
            document.location = baseUrl+param
        }

        select = document.getElementsByTagName('select')[0]
        select.addEventListener('change', function(e) {
            setGetParameter(e.target.name, e.target.value)
        }, false);
    </script>
</html>
