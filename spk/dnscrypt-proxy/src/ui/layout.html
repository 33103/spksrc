<!DOCTYPE html>
<html>
    <head>
        <title>
            {{.Title}}
        </title>
        <!-- https://extjs.cachefly.net/ext-3.2.0/docs/ -->
        <link href="/scripts/ext-3.4/resources/css/ext-all.css" rel="stylesheet" type="text/css"/>
        <link href="/scripts/ext-3.4/resources/css/xtheme-blue.css" rel="stylesheet" type="text/css"/>
        <script src="/scripts/ext-3.4/adapter/ext/ext-base.js" type="text/javascript">
        </script>
        <script src="/scripts/ext-3.4/ext-all.js" type="text/javascript">
        </script>
    </head>
    <body>
        <script>
// Some credit goes to Remco Schellekens (Merty): http://www.mertymade.com/syno/
function estimateHeight() {
    var myWidth = 0, myHeight = 0;
    if( typeof( window.innerWidth ) == 'number' ) {
        //Non-IE
        myHeight = window.innerHeight;
    } else if( document.documentElement && ( document.documentElement.clientWidth || document.documentElement.clientHeight ) ) {
        //IE 6+ in 'standards compliant mode'
        myHeight = document.documentElement.clientHeight;
    } else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {
        //IE 4 compatible
        myHeight = document.body.clientHeight;
    }
    return myHeight;
}

var formAction = function(form, action) {
    var form = Ext.getCmp('formPanel');
    form.el.unmask();

    if (form && action.response.status == 200) {
        Ext.MessageBox.alert('Saved', action.result.msg);
    }
    else {
        Ext.MessageBox.alert('Failure', action.result.msg);
    }
}

Ext.onReady(function() {
    var saveBtn = new Ext.Button({
        name: 'save',
        text: 'Save',
        handler: function() {
            var form = Ext.getCmp('formPanel');
            form.getForm().submit({
                url: 'index.cgi',
            });
        }
    });
    var textArea = new Ext.form.TextArea ({
        hideLabel: true,
        name: 'file',
        value: '{{.FileData}}',
        style: 'font-family:monospace',
        grow: false,
        autoScroll: true,
        enableKeyEvents: true,
        width: '100%',
        height: estimateHeight(),
    });

    var form = new Ext.FormPanel({
        id: 'formPanel',
        layout: 'column',
        autoWidth: true,
        height: estimateHeight(),
        items: [textArea],
        buttons: [
            saveBtn,
            // {text: 'Cancel'}
        ]
    });
    form.render(document.body);

    Ext.EventManager.onWindowResize(function() {
        form.doLayout();
        form.setHeight(estimateHeight());
        textArea.setHeight(estimateHeight());
    });
});
        </script>
    </body>
</html>
